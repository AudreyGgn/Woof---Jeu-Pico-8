pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
function _init()
	create_player() 
	init_msg()
end

function _update()
	if not messages[1] then
		player_movement()
	end
	down()
	up()
	obstacle()
	update_msg()
end

function _draw()
	cls()
	draw_map()
	draw_player()
	draw_msg()
end
-->8
function draw_map()
	map (0,0,0,0,128,64)
end

function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

-->8
function create_player()
	p={x=6,y=4,sprite=16}
end

function player_movement()
	newx=p.x
	newy=p.y
		if (btnp(➡️)) newx+=1
		if (btnp(⬅️)) newx-=1
		if (btnp(⬇️)) newy+=1
		if (btnp(⬆️)) newy-=1

	if not check_flag(0,newx,newy) then
		p.x=newx
		p.y=newy
	end
end

function draw_player()
	spr(p.sprite,p.x*8,p.y*8)
end
-->8
-- fonction action descendre

function down()
	if (btn(4)) then --a enlever
	repeat 
		newy+=1
		newx=p.x
	until check_flag(0,newx,newy+1)
		p.x=newx
		p.y=newy
	end
end

-- fonction action monter

function up()
if (btn(4)) then -- a enlever
	repeat 
		newy-=1
		newx=p.x
	until check_flag(0,newx,newy+1)
		p.x=newx
		p.y=newy
	end
end
-->8
-- fonction obstacle

function obstacle()
	if check_flag(1,newx,newy) then
	create_msg("aveugle",
	"on s'arrete, que dois-je \nfaire?")
	end
	
	-- new sprite
	--boite de dialogue
end
	
-->8
-- messages

function init_msg()
	messages ={}
end

function create_msg(name,...)
	msg_title=name
	messages={...}
end

function update_msg()
	if (btn(❎)) then
		deli(messages,1)
	end
end

function draw_msg()
	if messages[1] then
		local y=100
		if p.y%16>9 then
		y=10
		end
		--title
		rectfill(7,y,
		6+#msg_title*4,y+6,2)
		print(msg_title,7,y+1,7)
		--message
		rectfill(3,y+8,124,y+24,4)
		rect(3,y+8,124,y+24,2)
		print(messages[1],6,y+11,15)
	end
end


__gfx__
00000000444444443333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000444444443333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888883333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00999900000000000099990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09000090000000000999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000009000000009919919900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90900909000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000009000000009599995900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
90000009000000009955559900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09000090000000000998899000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00999900000000000099990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020212020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
