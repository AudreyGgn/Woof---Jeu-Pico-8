pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
--mandatory

function _init()
 create_player()
	init_msg()
	create_msg("0","allez babbage, en route pour \nada, c'est mon premier jour !")
end
	

function _update()
 if not messages[1] then
		player_movement()
	end
	update_msg()
	update_camera()
	woof()
	var()
	monter()
	descendre()
end


function _draw()
 cls()
 draw_map()
 draw_player()
 draw_msg()
end
-->8
--map, camera, check flag

function draw_map()
	map (0,0,0,0,32,16)
end

function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

function update_camera()
 local camx=mid(0,p.x-7.5,31-15)
 camera(camx*8)
end

-->8
--player

function create_player()
 p={x=6,y=4,sprite=1}
end
-- modifier coordonnees debut

function draw_player()
	spr(p.sprite,p.x*8,p.y*8)
end


function player_movement()
 newx=p.x
 newy=p.y
 
 newx+=0.05
 
 if not check_flag(0,newx,newy) then
		p.x=newx
		p.y=newy
	end
end
-->8
--messages

function init_msg()
 messages={}
end

function create_msg(name,...)
 msg_title=name
	messages={...}
end

function update_msg()
	if (btnp(❎))then
	deli(messages,1)
	end
end

function draw_msg()
	if messages[1] then
		local y=100
		if p.y%16>9 then
		y=10
		end
		rectfill(3,y+8,124,y+24,4)
		rect(3,y+8,124,y+24,2)
		print(messages[1],6,y+11,15)
	end
end
-->8
--fonctions

function woof()
 if (btnp(⬅️)) sfx(0) 
 if (btnp(⬆️)) sfx(1)
 if (btnp(⬇️)) sfx(2)
 if (btnp(➡️)) sfx(3)
end


a="a"
b="b"
c="c"
d="d"
air=""

function var()
 if (btnp(⬅️)) then air=air.."a" end
 if (btnp(⬆️)) then air=air.."b" end
 if (btnp(⬇️)) then air=air.."c" end
 if (btnp(➡️)) then air=air.."d" end
end 


function monter()
 if (air == "dcb")
 then
   up()
  end if not (air == sub("dcb",0,#air))
  then air="", create_msg("0","je n'ai pas compris, babbage. recommencons !")
 end
end

function up()
	repeat
		newy-=1
		newx=p.x
	until check_flag(0,newx,newy+1)
		p.x=newx
		p.y=newy
		air=""
end


function descendre()
 if (air == "abc")
 then
   down()
  end if not (air == sub("abc",0,#air))
  then air="", create_msg("0","je n'ai pas compris, babbage. recommencons !")
 end
end

function down()
	repeat
		newy+=1
		newx=p.x
	until check_flag(0,newx,newy+1)
		p.x=newx
		p.y=newy
		air=""
end

__gfx__
00000000099999009999900055555555eeeeeeee6666666657777775666666668888888800000000000000000000000000000000000000000000000000000000
000000000f5f5000f5f50000ddddddddfefffffe7677777656666665567777758888888800000000000000000000000000000000000000000000000000000000
007007000ffef000ffef0000fefffffefefffffe767777765dddddd5567777758888888800000000000000000000000000000000000000000000000000000000
000770003333340033330400fefffffefefffffe76777776511111155dddddd58888888800000000000000000000000000000000000000000000000000000000
00077000f3333454f3345400eeeeeeeeeeeeeeee6666666657777775511111158888888800000000000000000000000000000000000000000000000000000000
00700700fc444444fcc44440ffffefffffffefff7777677756666665577777758888888800000000000000000000000000000000000000000000000000000000
0000000004444400c00c0444ffffefffffffefff777767775dddddd55dddddd58888888800000000000000000000000000000000000000000000000000000000
000000000c40c400c00c4444eeeeeeeeeeeeeeee6666666651111115511111158888888800000000000000000000000000000000000000000000000000000000
__map__
0505050505050505050505050505050505050505050505050505050505050505080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050505050505080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050505050505080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050505050505080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050703030303080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303070505050505050505050505050505050505050505050605050505080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505060505050505050505050505050505050505050505050605050505080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505060505050703030303070505050505050505050505050605050505080909000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505060505050605050505060505050505050505050505050605050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505060505050605050505060505050505050507030303030305050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505060505050605050505030303030705050506050505050505050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505030303030305050505050505050605050506050505050505050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050303030303050505050505050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050505050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050505050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050505050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080808080808080808080808080808080808080808080808080808080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3434343434343434343434343434343400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0909090909090934343434090909090900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100002a0502c05030050320503405036050360503505033050300502c0502905024050200501d0501805016050110500f0500c050090500505003050020500105000050000500000000000000000000000000
0001000014050190501b0501e05022050250502605027050270502705027050260502505022050200501c050190501505013050110500f0500c05009050070500405004050020500105001050000500000000000
00010000180501a0501d0501e0501d0501d0501c0501b0501a0501805014050110500f0500b050080500605003050020500005000050000500000000000000000000000000000000000000000000000000000000
000100000f0501405015050150501405013050110500e0500c0500a05008050060500305002050000500005001050010500000000000000000000000000000000000000000000000000000000000000000000000
