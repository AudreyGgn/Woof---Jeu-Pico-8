pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
--mandatory

function _init()
 create_player()
	init_msg()
	create_msg("0","allez babbage, en route pour \nada, c'est mon premier jour !")
end
	

function _update()

 woof()
	var()
	var2()
	
 if not messages[1] then
		player_movement()
	end
	
	update_msg()
	update_camera()
	flag_down()
	flag_up()
end


function _draw()
 cls()
 draw_map()
 draw_player()
 draw_msg()
end
-->8
--map, camera, check flag

function draw_map()
	map (0,0,0,0,32,16)
end

function check_flag(flag,x,y)
	local sprite=mget(x,y)
	return fget(sprite,flag)
end

function update_camera()
 local camx=mid(0,p.x-7.5,31-15)
 camera(camx*8)
end

-->8
--player

function create_player()
 p={x=2,y=4,sprite=1}
end


function draw_player()
	spr(p.sprite,p.x*8,p.y*8)
end


function player_movement()
 newx=p.x
 newy=p.y
 
 newx+=0.05
 
 if not check_flag(0,newx+0.95,newy) then
		p.x=newx
		p.y=newy
	end
end
-->8
--messages

function init_msg()
 messages={}
end

function create_msg(name,...)
 msg_title=name
	messages={...}
end

function update_msg()
	if (btnp(❎))then
	deli(messages,1)
	end
end

function draw_msg()
	if messages[1] then
		local y=100
		rectfill(3,y+8,124,y+24,1)
		rect(3,y+8,124,y+24,13)
		print(messages[1],6,y+11,7)
	end
end
-->8
--fonctions pour jouer


--flag actions

function flag_down()
 if check_flag(1,newx,newy)
 then draw_var()
 end
end

function flag_up()
 if check_flag(2,newx,newy)
 then draw_var2()
 end
end


--aboiements

function woof()
 if (btnp(⬅️)) sfx(0) 
 if (btnp(⬆️)) sfx(1)
 if (btnp(⬇️)) sfx(2)
 if (btnp(➡️)) sfx(3)
end


--fonctions pour commande

-- pour descendre

a="a"
b="b"
c="c"
d="d"
air=""

function var()
 if (btnp(⬅️)) then air=air.."a" end
 if (btnp(⬆️)) then air=air.."b" end
 if (btnp(⬇️)) then air=air.."c" end
 if (btnp(➡️)) then air=air.."d" end
end 

function draw_var()
 print(air,10,2,1) 
 if (air == "dcb")
 then
   down()
  end if not (air == sub("dcb",0,#air))
  then air="", create_msg("0","bin non")
 end
end

function down()
	repeat
		newy+=1
		newx=p.x
	until check_flag(0,newx,newy+1)
		p.x=newx
		p.y=newy
		air=""
end


-- pour monter

air2=""

function var2()
 if (btnp(⬅️)) then air2=air2.."a" end
 if (btnp(⬆️)) then air2=air2.."b" end
 if (btnp(⬇️)) then air2=air2.."c" end
 if (btnp(➡️)) then air2=air2.."d" end
end 

function draw_var2()
 print(air2,10,2,1) 
 if (air2 == "abc")
 then
   up()
  end if not (air2 == sub("abc",0,#air2))
  then air2="", create_msg("0","bin non2")
 end
end

function up()
	repeat
		newy-=1
		newx=p.x
	until check_flag(0,newx,newy+1)
		p.x=newx
		p.y=newy
		air2=""
end



__gfx__
00000000099999009999900055555555eeeeeeee66666666577777756666666688888888000aa000000aa0000000000000000000000000000000000000000000
000000000f5f5000f5f50000ddddddddfefffffe76777776566666655677777588888888000aa00000aaaa000000000000000000000000000000000000000000
007007000ffef000ffef0000fefffffefefffffe767777765dddddd55677777588888888000aa0000aaaaaa00000000000000000000000000000000000000000
000770003333340033330400fefffffefefffffe76777776511111155dddddd588888888aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000
00077000f3333454f3345400eeeeeeeeeeeeeeee66666666577777755111111588888888aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000
00700700fc444444fcc44440ffffefffffffefff777767775666666557777775888888880aaaaaa0000aa0000000000000000000000000000000000000000000
0000000004444400c00c0444ffffefffffffefff777767775dddddd55dddddd58888888800aaaa00000aa0000000000000000000000000000000000000000000
000000000c40c400c00c4444eeeeeeeeeeeeeeee66666666511111155111111588888888000aa000000aa0000000000000000000000000000000000000000000
00000000000000000000000000000000000000006666666600000000000000000000000000000000000000000000000066666666166666660000000000000000
000000000000000000000000000000000000000076777776000000000000000000000000000000000000000000000000767d7776167d77760000000000000000
00000000000000000000000000000000000000007677777600000000000000000000000000000000000000000000000076d1177616d117760000000000000000
0000000000000000000000000000000000000000767777760000000000000000000000000000000000000000000000007d1111761d1111760000000000000000
000000000000000000000000000000000000000066666666000000000000000000000000000000000000000000000000d1111116d11111160000000000000000
0000000000000000000000000000000000000000777767770000000000000000000000000000000000000000000000007aaaaa771aaaaa770000000000000000
00000000000000000000000000000000000000007777677700000000000000000000000000000000000000000000000077111777171117770000000000000000
00000000000000000000000000000000000000006666666600000000000000000000000000000000000000000000000066616666166166660000000000000000
11111111111111111111111111111111111166660000000011111111111111111111111116666666666666666666666666616666166166660000000000000000
17777777777777777777777777777777777177770000000017777777777777777777777717677776717777767677717676717776167177760000000000000000
17117771171111171111171111117111117177770000000017111117117117111711111717677776414444444444414676717776167177760000000000000000
17111711171111171111171111117111117177770000000017111117117117111711111717677776717777767677717676717776767177760000000000000000
17111111171117771111171117117111117166660000000017111777111117111711111716666666414444444444414666616666666166660000000000000000
17111111171111777111771117117117117176770000000017111177711177111771117717777677717767767777617777716777777167770000000000000000
17111111171117777111771111177117117176770000000017111777111117111771117717777677711111111111117777716777777167770000000000000000
17117171171111177111771111117111117166660000000017111117117117111771117716666666616666666666616666616666666166660000000000000000
17117771171111177111771117117111117166660000000017111117117117111771117716666666000000000000000066616666666166660000000000000000
17777777777777777777777777777777777177760000000017777777777777777777777716777776000000000000000076717776767177760000000000000000
11111111111111111111111111111111111177760000000011111111111111111111111116777776000000000000000076717776767177760000000000000000
76777776767777767677777676777776767777760000000076777767767777677677776776777776000000000000000076717776767177760000000000000000
66666666666666666666666666666666666666660000000066666666666666666666666666666666000000000000000066616666666166660000000000000000
77776777777767777777677777776777777767770000000077776777777767777777677777777677000000000000000077716776777167760000000000000000
77776777777767777777677777776777777767770000000077776777777767777777677777777677000000000000000077d1177677d117760000000000000000
6666666666666666666666666666666666666666000000006666666666666666666666666666666600000000000000006d1111666d1111660000000000000000
11111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000
17777777777777777777777777777777777777777777777777777777777777710000000000000000000000000000000000000000000000000000000000000000
17111711771117771117111711171717777111711171717717771771777717710000000000000000000000000000000000000000000000000000000000000000
17171717171717777177177717771717777177717771717171717171777771710000000000000000000000000000000000000000000000000000000000000000
17111717171117777177117717771117777111717771117171717171771111110000000000000000000000000000000000000000000000000000000000000000
17171717171717777177177717771717777771717771717171717171777771710000000000000000000000000000000000000000000000000000000000000000
17171711771717777177111711171717777111711171717717771771117717710000000000000000000000000000000000000000000000000000000000000000
11111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000100000000010204000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0505050505050505050505050505050505050505050505050505050505050505080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
052021222324050505050505050505050505050505050505050505052627281d080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1c3031323334050505050505050505050505050505050505050505053637382d080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2c0505050505050505050505050505050505050505050505050505050505053d080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3c2a2b0505090805050505404142434445464705050505050505050803030303080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030303070505050505050505050505050505050505050505050604040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404060505050505050505090805050505050505051c05050604040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04040404040605050508030303030705051c0505050505052c05050604040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04040404040605050506040404040605052c0505050505053c05050a08040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04040404040605050506040404040605053c0908050508030303030304040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404060505050a08040404030303030705050506040404040404040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
040404040403030303030404040404040404060505050a080404040404040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040303030303040404040404040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040404040404040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040404040404040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040404040404040404040404040404040404080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0808080808080808080808080808080808080808080808080808080808080808080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100002a0502c05030050320503405036050360503505033050300502c0502905024050200501d0501805016050110500f0500c050090500505003050020500105000050000500000000000000000000000000
0001000014050190501b0501e05022050250502605027050270502705027050260502505022050200501c050190501505013050110500f0500c05009050070500405004050020500105001050000500000000000
00010000180501a0501d0501e0501d0501d0501c0501b0501a0501805014050110500f0500b050080500605003050020500005000050000500000000000000000000000000000000000000000000000000000000
000100000f0501405015050150501405013050110500e0500c0500a05008050060500305002050000500005001050010500000000000000000000000000000000000000000000000000000000000000000000000
